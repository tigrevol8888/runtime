<!DOCTYPE html>
<style>

@import url(style.css);

</style>
<p>This is foo:
<div class="result" id="foo"></div>
<p>And this is bar:
<div class="result" id="bar"></div>
<script src="/build/d3-express.js"></script>
<script>

var module = d3.runtime().module();

var foo = module.variable(document.querySelector("#foo")).define("foo", [], function() {
  return Math.random();
});

var bar = module.variable(document.querySelector("#bar")).define("bar", ["foo"], function(foo) {
  return new Promise(function(resolve) {
    setTimeout(function() {
      resolve(foo);
    }, 250);
  });
});

setTimeout(function() {
  foo.define("foo", [], function() {
    return [1, 2, 3, 4, 5];
  });
}, 750);

</script>
